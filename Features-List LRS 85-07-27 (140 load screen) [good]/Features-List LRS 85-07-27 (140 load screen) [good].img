( FEATURE LIST   LRP  7/27/85 )                                                                                                                                 143 154 THRU                                                                                    e, OR relations are compiled.                                           The last address, o, is the CFA of      either NOT or NOOP, depending upon                                                                                                                          relations. )                                                                VARIABLE CONT-FLAG                        ( 0 to continue compilation,              1 to stop )                                                                         else it returns 0.                                                                      The next m addresses are the CFAs of    either AND or OR. If the AND/OR-FLAG is true when the features list is compiled,then AND relations are compiled.        Otherwis                        VARIABLE AND/ORS                          ( Specifies how many AND/OR relations     in the features list. )                                                     VARIABLE AND/OR-FLAG                      ( 1 if AND relations; 0 if OR e array is a count of   the number of addresses in the array.                                           The first n addresses are tests of a    data structure to determine whether     or not a particular feature exists.     It it does, the test returns 1, ( FEATURE LIST   LRP  7/27/85 )                                                 : FEATURES ;                                                                    VARIABLE HEAD                             ( Adr of features list. )                             ( FEATURE LIST   LRP  7/27/85 )                                                 EXIT                                                                            A features list is a 2(n+m+o)+1 array ofn+m+o executable addresses (CFAs). The  first item in th                                                                                                                                                                                                                                                                c Recognition of Natural        Language, The MIT Press, Cambridge, MA.,1980, pp 258                                                                    Routine takes 780 bytes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 EXIT                                                                            See Marcus, Mitchell P., A Theory of    Syntacti when the feature list  is compiled, then o is the CFA of NOT,  else it is the CFA of NOOP.                                                                                                                                                                                                                                                                                                                                                                                                                                     ( FEATURE LIST   LRP  7/27/85 )                                                 EXIT                                                                            whether or not the evaluation of the    feature list should be negated. If      NOT-FLAG is true                                                                                                                                                                                                                                                                ( FEATURE LIST   LRP  7/27/85 )                                                 VARIABLE NOT-FLAG                        ( If 1, negate feature list )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     DUP DUP 0 SWAP C@ + C!                  DUP C@ 1- SWAP C! ;                                                                                                                                                                                                                     HERE HEAD !                             0 C, ;                                                                       : INC-FLIST-COUNT   ( -- )                 ( Increment features list count )       HEAD @ DUP C@ 1+ SWAP C! ;   4 = ;                                                           : DEC-COUNT ( adr -- )                              ( replace last char of                    string at adr with 0,                   and decrement count of                  string. )         ( FEATURE LIST   LRP  7/27/85 )                                                 : INIT-FLIST    ( -- )                     ( Initializes a features list. )        1 AND/OR-FLAG !                         0 NOT-FLAG !                            0 AND/ORS !  ( FEATURE LIST   LRP  7/27/85 )                                                 : COMMA?  ( adr -- f )                            ( is last char of packed                  string at adr a comma?                  If yes return 1 else 0. )      DUP C@ + C@ 4comma with 0, decrement count   of <WORD>, increment AND/ORS, and       return CFA of <WORD>. If <WORD> is      not found in the dictionary, return     0.                                                                                                                                                                                                                                                                                                                                                                                             0                                     THEN ;                                                             EXIT                                                                            If last char of <WORD> is a comma,      replace                                                                                                                                                                                                                                                                  AND/ORS +!                          THEN                                    CONTEXT @ @ 2+                          CONTEXT @ 999 - <<FIND>                 IF                                        DROP CFA                              ELSE                                                                                                                                                                                                                                                                               ( FEATURE LIST   LRP  7/27/85 )                                                 : FIND,  ( e.g. FIND, <WORD> )            BL WORD                                 DUP COMMA? IF                                        DUP DEC-COUNT                           1                                                                                                                                                                                                                                                                ( FEATURE LIST   LRP  7/27/85 )                                                 : ,AND/ORS   ( -- )                        AND/ORS @ 0 DO                                        INC-FLIST-COUNT                         AND/OR-FLAG @                                                                                                                                                                                                                                                                                                                       DROP                                    MORE          ELSE                    , INC-FLIST-COUNT                       THEN THEN THEN THEN ;                                                                                                                                                                                                                                                                                                                                                         = IF                                        DROP                                    /NOT MORE     ELSE   DUP ' NONE CFA = IF                                        DROP                                    NONE MORE     ELSE   DUP ' OF CFA   = IF                                      ELSE                                      ' NOOP CFA ,                          THEN ;                                                                                                                                               ( FEATURE LIST   LRP  7/27/85 )                                                 : ,FEATURE  ( adr -- )                    DUP ' ANY CFA  = IF                                        DROP                                    ANY MORE      ELSE   DUP ' /NOT CFA( FEATURE LIST   LRP  7/27/85 )                                                 : ,NOT   ( -- )                            INC-FLIST-COUNT                         NOT-FLAG @                              IF                                        ' NOT CFA ,                                                                                                                                                                                                                                                                le.                                                                                                                                                                                                                                                                                                             : NONE  ( -- )                             1 NOT-FLAG !                            0 AND/OR-FLAG ! ;                                                            : OF  ;                                                 EXIT                                                                            Depending upon state of AND/OR-FLAG,    compiles AND or OR relations at end     of features list. Value stored in       AND/ORS specifies how many relations    to compi ;                                                              : ANY  ( -- )                              0 AND/OR-FLAG ! ;                                                            : /NOT  ( -- )                             1 NOT-FLAG ! ;                IF                                        ' AND CFA ,                           ELSE                                      ' OR CFA ,                            THEN                                   LOOP ;                                                  ( FEATURE LIST   LRP  7/27/85 )                                                 : MORE   ( -- )                            0 CONT-FLAG ! ;                                                              : NO-MORE  ( -- )                          1 CONT-FLAG !                                                                                                                                                                                                                                                                ( FEATURE LIST   LRP  7/27/85 )                                                 EXIT                                                                            The following word, IS, compiles a      feature list at HERE. The address of thelist is stored i    THEN                                    ,NOT ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          AND/ORS @   <                           IF  MORE  THEN                        CONT-FLAG @                             UNTIL                                   AND/ORS @ IF                                        ,AND/ORS                                                                                                                                                                                                                                                                                                                      FIND, DUP IF                                        ,FEATURE                              ELSE                                      ." Undefined feature"                   ABORT                                 THEN                                                                                                                                                                                                                                                                              ( FEATURE LIST   LRP  7/27/85 )                                                 : IS     ( -- )                            INIT-FLIST                              BEGIN                                    NO-MORE                                 AND/ORS @                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   OOP         DROP ;                                                                                                                                                                                                                                              ist>          IS NOT ANY OF <feature list>            IS NONE OF <feature list>                                                                                                                                                                                 ECUTE                            LOOP ;                                                                 : Q                                         HEAD @                                  COUNT                                   0 DO DUP I 2* + @ EXECUTE /Ln HEAD. QQ, on screen   154, is an example of how to evaluate   the feature list.                                                                e.g. IS (all of) <feature list>              IS ANY OF <feature list>                IS NOT (all of) <feature l( FEATURE LIST   LRP  7/27/85 )                                                 : QQ     ( -- )                             HEAD @                                  C@ 0 DO                                         I 2 * HEAD @ + 1+                       @ EX                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ( FEATURES 2     LRP  7/29/85 )                                                                                                                                                                                                                                                                 See Basile, James, "Implementing Data   Structures in FORTH", The Journal of    Appl. and Research, Vol. 1, No. 2,      DEC. 1983, p. 5                                                                                                                                                                                                                                                                                                                                                                                                         : LOOK-UP  ( defining: #entries -- )       CREATE  C,                              DOES>                                    DUP ROT (LOOK-UP) SWAP - ;                                                  EXIT                                                                                                                                                                                                                                                                    O                                        DUP I C@ =                              IF                                        SWAP DROP                               I SWAP LEAVE                          THEN                                  LOOP DROP ;      ( FEATURES 2     LRP  7/29/85 )                                                                                                                                                                                                                                 ( FEATURES 2     LRP  7/29/85 )                                                 : (LOOK-UP)   ( table adr value --                      found-adr/table adr )      OVER                                    COUNT                                   OVER + SWAP D                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ( FEATURES 2     LRP  7/29/85 )                                                 ( Example: )                                                                      5 LOOK-UP ?VOWEL 65 C, 69 C, 73 C,                       79 C, 85 C,                                                                                                                                                                                                                                                                                          ( FEATURES 2     LRP  7/29/85 )                                                 EXIT                                                                            The next version of LOOK-UP is for      word-length data                                                                        See Basile, James, "Implementing Data   Structures in FORTH", The Journal of    Appl. and Research, Vol. 1, No. 2,      DEC. 1983, p. 5                                                                                                                                                                                                                                                                                                                                                                                                         : 2LOOK-UP  ( defining: #entries -- )      CREATE  2* C,                           DOES>                                    DUP ROT (2LOOK-UP) SWAP - 1+ 2/ ;                                           EXIT                                                                                                                                                                                                                                                                    O                                        DUP I @ =                               IF                                        SWAP DROP                               I SWAP LEAVE                          THEN                                  2 +LOOP DROP ;                                                                                                                                                                                                                                                                   ( FEATURES 2     LRP  7/29/85 )                                                 : (2LOOK-UP)   ( table adr value --                      found-adr/table adr )     OVER                                    COUNT                                   OVER + SWAP D                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ,                                               : PRIORITY                                  OPERATORS 2* PRIORITIES + @ ;                                                                                                                                                                                                                                                                                                                                                                                                          50 ,                                                         3 2LOOK-UP OPERATORS ' AND CFA ,                             ' OR CFA ,                              ' NOT CFA ,                                                CREATE PRIORITIES 0 , 2 , 3 , 2                                                                                                                                                                                                                                                                 ( FEATURES 2    LRP   7/29/85 )                                                                                         ( Example: )                                                                     5 2LOOK-UP TEST   10 , 20 , 30 , 40 ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             (           0           4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            TACK   INCOMING         OPERATOR    PRIORITY   PRIORITY                                                    )          --          --               NOT         3           4               AND         2           2               OR          1           1                                                                                                                                                                                                                                                                                                                                                    EXIT                                                                            PRIORITY TABLE                                                                              IN-S                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                : 2LOOK-UP  ( defining: #entries -- )      CREATE  2* C,                           DOES>                                    DUP ROT (2LOOK-UP) SWAP - 1+ 2/ ;                                           EXIT                                                                                                                                                                                                                                                                    O                                        DUP I @ =                               IF                                        SWAP DROP                               I SWAP LEAVE                          THEN                                  2 +LOOP DROP ;                                                                                                                                                                                                                                                                   ( FEATURES 2     LRP  7/29/85 )                                                 : (2LOOK-UP)   ( table adr value --                      found-adr/table adr )     OVER                                    COUNT                                   OVER + SWAP D                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ( FEATURES 2     LRP  7/29/85 )                                                                                                                                                                                                                                                                 See Basile, James, "Implementing Data   Structures in FORTH", The Journal of    Appl. and Research, Vol. 1, No. 2,      DEC. 1983, p. 5                                                                                         ( FEATURES 2    LRP   7/29/85 )                                                 : .( ;    : ). ;                                                                5 2LOOK-UP OPERATORS ' NOT CFA ,                             ' AND CFA ,                        0. ICP returns the in-coming    priority of the operator.                                                                                                                                                                                                                   REPEAT ;                                                                                                                                                                                                                                            SP      returns the                             in-stack priority ( See Horowitz,       Ellis and Sartaj Sahni, Fundamentals of Data Structures, Computer Science Press,Inc., 1976, p 96) if the word is definedas an operator by OPERATORS, else it    returns    DDUP                                    ICP  SWAP ISP <                       ELSE                                      0                                     THEN                       WHILE                                     SWAP ,                    )                          OPERATORS                               (ICP) ;                                                                      EXIT                                                                            Given the CFA of a FORTH word, I( FEATURES 2    LRP   7/29/85 )                                                 : ,TO-ISP<ICP    ( n n n -- n )             ( , until ISP < ICP )                   BEGIN                                     DEPTH  1 > IF                                     ( FEATURES 2    LRP   7/29/85 )                                                 : ISP  ( n -- n )                          OPERATORS                               (ISP) ;                                                                      : ICP  ( n -- n                                                                                                                                                                                                                                                                                                 4 PRIORITIES (ISP) 3 2 1 0              4 PRIORITIES (ICP) 4 2 1 4                                                                                                                                                                            DUP ' .( CFA = NOT                    WHILE                                     ,                                     REPEAT DROP ;                                                                                                                             0 ,                                     0 DO                                       BL WORD NUMBER DROP ,                  LOOP                                DOES>                                     SWAP 2* + @ ;                                                            ,                                     REPEAT ;                                                                   : ,TO.(     ( n ... n -- n )                ( , until CFA for .( )                  BEGIN                            ' OR  CFA ,                             ' .(  CFA ,                             ' ).  CFA ,                                                : PRIORITIES  ( defining                              ( n -- n )                    CREATE                      ( FEATURES 2    LRP   7/29/85 )                                                 : ,TO-OUT   ( n ... n -- )                   ( , until stack empty )                 BEGIN                                     DEPTH                                 WHILE                                                                                                                                                                                                                                                                      ( FEATURES 2    LRP   7/29/85 )                                                 : ]. ;                                                                          : .[                                        BEGIN                                     FIND DUP                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  I @ EXECUTE 2 +LOOP ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ELSE                              ,TO-ISP<ICP                          THEN THEN          REPEAT                                  DROP                                    ,TO-OUT ;                                                                   : Q  DO                                                                                                                                                                                                                                                                                               ' ]. CFA = NOT                        WHILE                                     DUP OPERATORS  NOT IF   ,   ELSE        DUP ' ). CFA =     IF DROP                                    ,TO.(                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       