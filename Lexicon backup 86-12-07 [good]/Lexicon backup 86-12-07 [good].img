( LEXICON                <11/22/86>140)                                         : LEX ;                                                                                                                 150     LOAD \  Constants               151 152 THRU \                                                                                                                                                                                         (  4:17)                                                                                                                                                                                                                                                                                                                                          Input word for testing. Word with       count byte is returned in ADR1.                                                                                                                                                                                 added node in           RECENT.                                                                                                                                                                                                                                m main memory                                                   <LCMOVE  ( vir-adr adr c -- )            Move string from virtual to             main memory                                                                    GET      ( GET word )           ( DOCUMENTATION          <11/22/86>143)                                         NEWWORD ( adr -- )                       Add word at adr to lexicon. If          the word is already in lexicon,         increment the count in >CONCEPT.        Return found or( DOCUMENTATION          <11/22/86>141)                                         LEX-INIT  ( -- )                         Initialize lexicon node space                                                  >LCMOVE  ( adr vir-adr c -- )            Move string fro -1, 0 , +1                                                                                                                                                                            (  4:17)                                                                                                                                                                                                                                                        (  4:17)                                                                         L-NODE  ( vir-adr -- )                   Print lex node at vir-adr                                                      L-$=  ( adr vir-adr -- f )               Compare string at adr and string        data in lexicon node at vir-adr.        Returns                                                                                                                                                                                                                                                                ee ptr                   2 is right subtree ptr                  4 is concept data ptr                   6 is string data                        Head of node is returned in             RECENT                                                                 Store/fetch prims.      153 162 THRU \  Lexicon data structures              \  and NEWWORD             164 172 THRU \  Input string parser                                                                                                                     ( DOCUMENTATION          <11/22/86>142)                                         L-NODE  ( adr -- )                       Make tree node                          Adr is address of string to be          stored in ID                            0 is left subtr                                                                                                                                                                                       (  4:17)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 TE ;                                                            : L-C@  ( adr -- n )                       L-ADR C@ ;                                                                                                                                                                                                                                                                                                                                                                                                           ( L-ADR L-C! L-C@        <11/22/86>151)                                         : L-ADR  ( adr -- vir-adr )                1K /MOD L-BLOCKS + BLOCK + ;                                                 : L-C!  ( n adr -- )                       L-ADR C! UPDA                                                                                                                                                                                                                                                                           \ space                                                                                                                                                                     (  4:17)                                                                                                                                                                                                                                                                                                                                         0 CONSTANT L-FREE  \ Ptr to free space  2 CONSTANT L-ROOT  \ Root of lexicon    4 CONSTANT RECENT  \ Most recent node   6 CONSTANT ENTRIES \ Number of words                       \ in lexicon         8 CONSTANT L-NODES \ Beginning of node                                                                                                                                                                                                                                                                                                  229 CONSTANT L-BLOCKS                      \ First block of lexicon                                                     50 1K * CONSTANT END                       \ Last vir-adr of lexicon                                                                                                                                                                                                                                                                                                            ( TRUE FALSE 1K L-BLOCKS <11/22/86>150)                                         1 CONSTANT TRUE                         0 CONSTANT FALSE                                                                1024 CONSTANT 1K                                                                                                                                                                                                                               (  4:17)                                                                 ( L-! L-@ L-+! L-COUNT   <11/22/86>152)                                         : L-!   ( n adr -- )                       >R 256 /MOD R@ L-C!                                 R> 1+ L-C! ;                                                     : L-@   ( adr --                                                                                                                                                                                       (  4:17)                                                                            IF                                        DROP -1                               ELSE                                      0>                                    THEN ;                                                                                           \ Out of room in lexicon?               L-FREE L-@ + END <                      ABORT" LEXICON FULL" ;                                                                                                                                              WORD ADR1                      10 CMOVE ;                                                               : COMPARE ( n1 n2  -- f )                  \ Flag is -1 if n1 < n2; 0 if n1        \ = n2; +1 if n1 > n2                   - DUP 0<                     IES L-! ;                                                       : INC-L-FREE  ( n -- )                      \ Increment lexicon free ptr            L-FREE L-+! ;                                                               : ?ROOM  ( n -- )               ( ADR1 GET COMPARE       <11/22/86>155)                                         \ TEST WORDS                                                                      CREATE ADR1 10 ALLOT                                                          : GET  QUERY BL ( LEX-INIT INC-L-FREE ?RO<11/22/86>153)                                         : LEX-INIT  ( -- )                          \ Initialize lexicon node space         L-NODES L-FREE  L-!                           0 L-ROOT  L-!                           0 ENTR                                                                                                                                                                                       (  4:17)                                                                                                                                                                                                                                                        (  4:17)                                                                            1+ 0 DO                                        OVER I + L-C@                           OVER I + C!                           LOOP DDROP ;                                                                                                            c )        DUP 1+ SWAP L-C@ ;                                                                                                                                                                                                                                    + C@                             OVER I + L-C!                         LOOP DDROP ;                                                            : <LCMOVE  ( vir-adr adr c -- )            \ Move string from virtual to           \ main memory                 n )                       DUP L-C@ 256 * >R 1+ L-C@ R> + ;                                             : L-+!  ( n adr -- )                       DUP L-@ ROT + SWAP L-! ;                                                     : L-COUNT  ( vir-adr -- vir-adr ( >LCMOVE <LCMOVE        <11/22/86>154)                                         : >LCMOVE  ( adr vir-adr c -- )            \ Move string from main memory          \ to virtual                            1+ 0 DO                                        OVER I                                                                                                                                                                                       (  4:17)                                                                 (                        <11/22/86>156)                                         EXIT                                                                                                                                                                                                                                                                                                                                                                   (  4:17)                                                                                                                                                                                                                                                                                                                                         6 FIELD ID                                                                                                                                                                                                                                              PT L-@ .                       CR ID DUP L-C@ 1+ PAD                   SWAP <LCMOVE                        PAD COUNT TYPE ;                                                                                                                                                                DOES>  ( n -- n1)                         @ + ;                                                                      0 FIELD >LT                             2 FIELD >GT                             4 FIELD >CONCEPT                ( .L-NODE                <11/22/86>159)                                         : .L-NODE  ( vir-adr -- )                  \ Print lex node at vir-adr             DUP CR >LT L-@ .                        DUP CR >GT L-@ .                        DUP CR >CONCE( FIELD                  <11/22/86>157)                                         : FIELD                                    \ Defining -- n FIELD <name>            \ Offset for data field                 CREATE                                    ,          VE R> INC-L-FREE ;                                                                                                                                                                     (  4:17)                                                                                                                                                                                                                                                                                                                                            L-FREE L-@ RECENT L-!                   3 0 DO                                        0 L-FREE L-@ L-!                        2 INC-L-FREE                          LOOP                                L-FREE L-@ OVER C@ 1+ DUP >R            >LCMO                                                                                                                                                                                                                                                                ubtree ptr                 \ 2 is right subtree ptr                \ 4 is concept data ptr                 \ 6 is string data                      \ Head of node is returned in           \ RECENT                                DUP C@ ?ROOM                                                                                                                                                                                                                                                                                 ( L-NODE                 <11/22/86>158)                                         : L-NODE  ( adr -- )                       \ Make tree node                        \ Adr is address of string to be        \   stored in ID                        \ 0 is left s                                                                                                                                                                                       (  4:17)                                                                 ( L-$=                   <11/22/86>160)                                         : L-$=  ( adr vir-adr -- f )                \ Compare string at adr and string      \ data in lexicon node at vir-adr.      \ Returns -1, 0 , +1                    OVER COUNT >ECENT L-!                          1 SWAP >CONCEPT L-+! DROP ;                                                                                                                         (  4:17)                                                                                                                                                                                                                                                                                                                                         : FOUND  ( adr vir-adr -- )                \ NOTE: Temporary definition.           \ For now, FOUND increments             \ counter maintained in >CONCEPT.       \ Vir-adr of node is returned in        \ RECENT.                               DUP RCR, parse out each      word in the line and convert it to      a counted string, filter out            punctuation, numerals, and other        unessential characters, and pass the    resulting word to NEWWORD.                                              r. Vir-adr of new          \ node is returned in RECENT.           SWAP L-NODE                             RECENT L-@                              SWAP L-!                                1 ENTRIES L-+! ;                                                     ( DOCUMENTATION          <11/22/86>163)                                         EXIT                                                                            Now we need an input line parser.       This word must get a line of text       terminated with ( ADDED FOUND            <11/22/86>161)                                         : ADDED  ( adr vir-adr --  )               \ Create new node, store string         \ at adr into node data field,          \ and store vir-adr of new node         \ into vir-adTHEN                               UNTIL ;                                                                                                                                             (  4:17)                                                                         ID L-C@ COMPARE                      ELSE                                       DDROP R>                             THEN ;                                                    (  4:17)                                                                                 ELSE                                     L-@  DDUP L-$=                          DUP 0< IF DROP >LT FALSE ELSE           DUP 0> IF DROP >GT FALSE ELSE                     DROP FOUND TRUE                      THEN THEN                                            DUP 0= NOT                              IF  LEAVE                               THEN                                 LOOP  >R DDROP R@                                  0= IF                              R> DROP SWAP C@ SWAP            d or added node in         \ RECENT.                               L-ROOT                                  BEGIN                                     DUP L-@                                 0= IF                                         ADDED  TRUE          R                           OVER ID L-COUNT R> MIN 0 SWAP               0 DO                                         DROP                                    OVER I + C@                             OVER I + L-C@                           COMPARE            ( NEWWORD                <11/22/86>162)                                         : NEWWORD ( adr -- )                       \ Add word at adr to lexicon. If        \ the word is already in lexicon,       \ increment the count in >CONCEPT.      \ Return foun                                                                                                                                                                                       (  4:17)                                                                 ( $BUF $BUF-INIT GET$    <11/22/86>164)                                         CREATE $BUF  81 ALLOT                     \ Input string buffer                                                         : $BUF-INIT                                \ Initialize                                                                                                                                                                                                                                                                                        DDUP I 2* + @                           = IF                                         I  LEAVE                             ELSE                                       99                                   THEN                                                                                                                                                                                                                                                                                                                             ASCII ,                              LOOP                                DOES>   \ ( char -- char f )              99 OVER                                     @ 1 DO                                        DROP                                                                                                                                                                                                                                                                             ( SET                    <11/22/86>167)                                         : SET   ( defining )                       \ n SET <name> char char ... char       CREATE                                    DUP 1+ ,                                0 DO       (                        <11/22/86>165)                                         EXIT                                                                                                                                                                                                                                                                                                                                                                   (  4:17)                                                                                                                                                                                                                                                        (  4:17)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 input string buffer        $BUF 81 0 FILL ;                                                             : GET$                                      \ Get input string                      $BUF-INIT                               $BUF 80 EXPECT ;            ( ASCII                  <11/22/86>166)                                         : ASCII  ( -- n )                            \ ASCII <char> returns ascii            \ value of char                         BL WORD 1+ C@ ;                                         LOOP                                    SWAP @ < ;                                                                                                                                (  4:17)                                                                 ( ?PUNC ?DIGIT           <11/22/86>168)                                          7 SET ?PUNC   . , : ; ! ) ?                                                    10 SET ?DIGIT  0 1 2 3 4 5 6 7 8 9                                                                                                                                                                                                                                                     (  4:17)                                                                                                                                                                                                                                                                                                                                                                                 : LASTCHAR  ( adr -- char )                \ Get last char of word at adr          DUP C@ + C@ ;                                                                                                                                             DROP                                    DUP DUP C@ 1+ NUM$ SWAP BMOVE           0 SWAP C!                             ELSE                                      DDROP                                 THEN ;                       LLOT                      \ Store numerical string                                                      : DEC-COUNT  ( adr -- )                   \ Decrement count at beginning of       \ string.                               -1 SWAP +! ;                  ( N-DELETE               <11/22/86>171)                                         : N-DELETE  ( adr -- )                     \ Copy numeric string to NUM$           NUM$ 20 0 FILL                          DUP LASTCHAR ?DIGIT                     IF           ( PUNCTUATION NUM$       <11/22/86>169)                                         VARIABLE PUNCTUATION                      \ Store ascii value of punctuation      \ mark.                                                                       CREATE NUM$ 20 A                                                                                                                                                                                       (  4:17)                                                                                                                                                                                                                                                        (  4:17)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              DUP LASTCHAR ?PUNC                    WHILE                                       PUNCTUATION !                           DUP DEC-COUNT                       REPEAT                                  DDROP ;                                                                                                                                                                                                                                                                                      ( P-DELETE               <11/22/86>170)                                         : P-DELETE  ( adr -- )                     \ Delete punctuation mark from          \ end of word at adr                    0 PUNCTUATION !                         BEGIN                                                                                                                                                                                               (  4:17)                                                                 ( PARSE                  <11/22/86>172)                                         : PARSE                                     \ Parse input string                    >IN @  TIB @                            $BUF TIB ! 0 >IN !                      BEGIN                                                                                                                                                                                              (  4:17)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  NEWWORD. NEWWORD looks up each word in the lexicon, adding     words that it can't find and counting   words that it can.                                                              GET$ <string>                           PARSE                                                                                                                                                                                                                                                                                           ( DOCUMENTATION          <11/22/86>173)                                         EXIT                                                                            To use: GET$ puts the input string into $BUF. PARSE parses the input string     and passes it to                                                                                                                                                                                                                                                                AT                                  TIB !  >IN ! ;                                                                                                                                     (  4:17)                                                                                                                                                                                                                                                                                                                                               IF                                        DUP NEWWORD                             CR COUNT TYPE                         ELSE                                      DROP                                  THEN                                  REPE                                                                                                                                                                                                                                                                                               'STREAM C@                           WHILE                                     BL WORD                                 DUP P-DELETE                            DUP N-DELETE                            DUP C@                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    l  J    THE    QUICK a (  BROWN U 2  FOX   ?  JUMPED J    OVER     LAZY      DOG'S      BACK.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                