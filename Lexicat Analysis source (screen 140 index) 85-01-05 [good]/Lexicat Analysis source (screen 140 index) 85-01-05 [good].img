( USEFUL ROUTINES     1/4/85 )                                                                                          MYSELF                      145         4LST FOR IMAGEWRITER        146-147     VIRTUAL STRING ARRAY        148-149     LIST STRUCTURES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     CR  202 205 THRU CR ." SORT"            CR  206     LOAD CR ." .FREQLIST"       CR                                                                                                                                                                                                                                                                                                                                                                                                                                          ." -TEXT"           CR  181     LOAD CR ." STRINGS=?"       CR  185     LOAD CR ." DATA STRUCTURES" CR  186     LOAD CR ." $BUFF  IN"       CR  187 190 THRU CR ." GROW"            CR  195 197 THRU CR ." .TRAVERSE"       CR  198 200 THRU CR ." STRIP"                                                                                                                                                                                                                                                                       ( LEXICAL ANALYSIS LOAD SCREEN )        ( LRP   1/6/85 )                                                                155 157 THRU CR ." LIST STRUCTURES" CR  160 166 THRU CR ." IT...TI"         CR  170 176 THRU CR ." INPUT"           CR  180     LOAD CR                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         GROW                        187-190     .TRAVERSE                   195-197     STRIP                       198-200     DOCUMENTATION NOTE          201         SORT                        202-205     .FREQLIST                   206                                                                                                                                                                                                                                                                                             155-157     IT...TI -- PARNAS           160-166     INPUT                       170-176     -TEXT                       180         STRINGS=?                   181         DATA STRUCTURES             185         $BUFF   IN                  186                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +LOOP 0 PR# ;                                                                                                        EXIT ........                                                                   CHANGE SOFFS TO SOMETHING OTHER THAN    ONE FOR                                                                                                                                                                                                                                                                  BCNT !                    1+ SWAP                                 DO CR I I SOFFS + 2LIST                  1 BCNT +! BCNT @ 1 AND 0=               IF PRFF THEN                            SOFFS 1 = 1+ ( 2 IF SOFFS=1, ELSE                      1)                                                                                                                                                                                                                                                                           ( 4LST FOR IMAGEWRITER   LRP 1/5/85 )                                           1 CONSTANT SOFFS                          VARIABLE BCNT                                                                 : 4LST  ( S E -- ; FROM S TO E )           ?2NUM 1 PR# 0                                                                                                                                                                                                                                                                0< NOT                              IF TAB 48 I OVER .LINE THEN            LOOP CR CR ;                                                                                                                                                                                                                                                                                                                                                                                                                                                    ." SCR NO. " OVER .  TAB48              DUP 0< NOT                              IF ." SCR NO. " DUP . THEN              15 EMIT                                 CR  24 0                                DO CR I 3 PICK .LINE                     DUP                                                                                                                                                                                                                                                                                         : TAB48  27 EMIT ." F 0350 " ;                                                  : 2LST ( S1 S2 - * ; PRINT S1 S2 )             ( IF S2 NEG DON'T PRINT )           14 EMIT                                 27 EMIT 69 EMIT CR                                                                                                                                                                                                                                                                           ( 4LST FOR IMAGEWRITER  1/5/85 )        ( WORKS WITH IMAGEWRITER PRINTER ONLY)                                          : PRFF 12 EMIT ;                                                                : TOF  1 PR# PRFF 0 PR#                                 SHADOW SCREENS                                                                                                                                                                                                                                                  ( VIRTUAL STRING ARRAY )                                                        : CLEAN   ( adr -- )                        R-LENGTH 32 FILL ;                                                          : WRITE   ( n -- )                          RECORD DUP C                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                LEAN 64 EXPECT UPDATE ;                                         : READ ( n -- )                             RECORD 64 -TRAILING TYPE ;                                                                                                                                                                                                                                                                                                                                                                                          ( VIRTUAL STRING ARRAY    1/5/85 )                                              : CLEAN ( adr -- )                          R-LENGTH 32 FILL ;                                                          : WRITE   ( n -- )                          RECORD DUP C                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                LEAN 64 EXPECT UPDATE ;                                         : READ    ( n -- )                          RECORD 64 -TRAILING TYPE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    DOES> ; DECIMAL                                                               ( n m CREATE-LIST <name> )              ( where n determines the number of )    ( list elements to be created and )     ( m is the number of bytes to be )      ( allote                                                                                                                                                                                                                                                                                        : CREATE-LIST                              CREATE  HERE 2+ ,  SWAP                 1 DO                                       HERE OVER 2+ + , DUP ALLOT             LOOP                                  0 , ALLOT                                                                                                                                                                                                                                                                                    ( LIST STRUCTURES     8/18/84 )         ( FORTH DIMENSIONS VOL. VI, #1, P 36 )                                          : LEX ;                                                                                                                 HEX                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             d for data storage )                                                                                                                                                                                                                                            ( LIST STRUCTURES )                                                             ( list -- le1 )                         : GET   DUP @ DUP @   ( list le1 le2 )          ROT ! ;       ( le1 remains )                                           ( le list -- )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     REPEAT 0 ." NOT FOUND " ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ( list -- le )                          : LAST   BEGIN DUP @ WHILE @ REPEAT ;                                           : DELIST   BEGIN DUP @ ?DUP WHILE           3 PICK = IF GET DDROP EXIT                       ELSE @ THEN                                                                                                                                                                                                                                                                        ( LIST STRUCTURES )                                                             ( list -- n )                           : #LIST  0 BEGIN OVER @ WHILE 1+             SWAP @ SWAP REPEAT                      SWAP DROP ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   @ REPEAT ! ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 : PUT   DUP @ 3 PICK ( le le1 list le )     ! ( list le ) ! ; ( stack empty )                                           ( le list -- )                          : APPEND   OVER 0 SWAP !                   BEGIN DUP @ WHILE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ( PARNAS' IT...TI STRUCTURE )                                                                                           : ROTB   ( N1 N2 N3 -- N3 N1 N2 )          ROT ROT ;                                                                    : BACK!  ( TO-AD                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                T CAND-ID# )               ?COMP COMPILE 0= COMPILE 0BRANCH        DUP 17 = IF ROT HERE SWAP , ROTB        ELSE 16 ?PAIRS HERE 0 , 0 17 THEN ;     IMMEDIATE                                                                                                    C ENDIT-LIST CAND-LIST       (     IFF-ID# -- )                    ?COMP DUP 18 = IF DROP HERE SWAP        BACKFILL 16 THEN 16 ?PAIRS HERE         SWAP BACKFILL DROP ; IMMEDIATE                                                                               ( IT...TI WORDS )                                                               : COR  ( IT-LOC ENDIT-LIST IT-ID# )         ( OR IT-LOC ENDIT-LIST CAND-LIST )      (    COR-LIST CAND-ID# -- IT-LOC )      (    ENDIT-LIST CAND-LIST )             (    COR-LIS( IT...TI WORDS )                                                               : IT  ( -- IT-LOC ENDIT-LIST IT-ID# )      HERE 0 16 ; IMMEDIATE                                                        : ENDIT  ( IT-LOC ENDIT-LIST IT-ID# )        ( OR  IT-LO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ST CAND-ID# )              ?COMP COMPILE 0BRANCH DUP               17 = IF    HERE ROT , SWAP                   ELSE  16 ?PAIRS 0 HERE 0 , 17           THEN ; IMMEDIATE                                                                                        R BRANCH ADDRESS -- )      SWAP OVER - SWAP ! ;                                                         : BACKFILL  ( TO-ADR LIST-ADR -- )         BEGIN DUP WHILE DUP @ >R OVER SWAP      BACK! R> REPEAT DROP DROP ;                                          ( IT...TI )                                                                     : CAND  ( IT-LOC ENDIT-LIST IT-ID#          ( OR  IT LOC ENDIT-LIST CAND-LIST       (     COR-LIST CAND-ID# -- IT-LOC )     (     ENDIT-LIST CAND-LIST  )           (     COR-LI                                                                                                                                                                                                                                                                ( IT...TI WORDS )                                                               : IFF  ( IT-LOC ENDIT-LIST IT-ID# )        ( OR  IT-LOC ENDIT-LIST CAND-LIST )     (     COR-LIST CAND-ID# -- IT-LOC )     (     ENDIT-LIST CAND-LIST IFF-ID# )    [COMPILE] CAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        : SUBCASES ( IT-LOC ENDIT-LIST )                   ( CAND-LIST IFF-ID# )                   ( -- CAND-LIST SUB-ID# )                ( IT-LOC ENDIT-LIST IT-ID# )      ?COMP 18 ?PAIRS ROTB 19 ROTB 16 ;       IMMEDIATE                                                                                                                                                                                                                                                                                                  ID# )                      ?COMP DUP 16 = IF 2+ 0 SWAP THEN        18 ?PAIRS >R COMPILE BRANCH OVER        HERE 0 , BACK! HERE R> BACKFILL         16 ; IMMEDIATE                                                                                                                                                                                                                                                                                                                                                               ( IT...TI WORDS )                                                               : CONTINUE ( IT-LOC ENDIT-LIST IT-ID# )         ( OR IT-LOC ENDIT-LIST )                (    CAND-LIST IFF-ID# )                (    -- IT-LOC ENDIT-LIST )             (    IT-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ?COMP DUP 16 = IF 2+ 0 SWAP THEN        18 ?PAIRS >R COMPILE BRANCH HERE        SWAP , HERE R> BACKFILL 16 ;            IMMEDIATE                                                                                                                    P BACKFILL 16 ;             IMMEDIATE                                                                                                                                                                                                                           D DROP HERE ROT            BACKFILL 18 ; IMMEDIATE                                                      : BREAK ( IT-LOC ENDIT-LIST IT-ID# )         ( OR IT-LOC ENDIT-LIST CAND-LIST )      ( IFF-ID# -- IT-LOC ENDIT-LIST )        ( IT-ID# )                 ( IT...TI WORDS )                                                               : ENDSUB  ( CAND-LIST SUB-ID# IT-LOC )            ( ENDIT-LIST IT-ID# -- )                ( IT-LOC ENDIT-LIST IT-ID# )      ?COMP 16 ?PAIRS ROT 19 ?PAIRS           ROT HERE SWA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                KSPACE                  127 CONSTANT DELETE                     13  CONSTANT RETURN                     255 CONSTANT MAX$                                                                                                                                                                                                                                                                                                                                                                                                       ( INPUT   LRP  9/30/84 )                                                        32  CONSTANT SP                         33  CONSTANT EXCLAM                     46  CONSTANT PERIOD                     63  CONSTANT QUESTION                   8   CONSTANT BAC                                                                                                                                                                                                                                                                is displayed. INPUT was written to get user input for ELIZA.                                                                                                                                                                                                                                                                                                                                                                                                                                                                    e       system receives either a backspace or a delete. Carriage Return gives both a    line feed and return. The CR ASCII      value is not stored in the string -- a  space character is stored instead. If   the input string is too long, an error  message                                                                                                                                                                                                                                                                 t puts the entire       sentence in PAD, preceeded by a count.  Backspace and Delete work. Backspace    causes the cursor to move one space to  the left.                               The string count at                     PAD is correctly updated when th                                                                                                                                                                                                                                                                ( INPUT      LRP    9/30/84 )                                                   EXIT                                    INPUT accepts any sentence up to 255    characters long and terminated by a     period, an exclamation mark, or a       question mark. I                                                                                                                                                                                                                                                                ( INPUT     LPR   9/30/84 )                                                     VARIABLE LONG  ( Counter for terminal )                ( line length )                                                  : START   ( -- )                           0 LONG ! ;                                                                                                                                                                                                                                                                   t adr )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         f string in PAD is )       ( > 0, shorten it by 1. )                                                    : !CHAR  ( c adr -- )                      DUP 1 SWAP +!                           DUP C@ + C! ;                           ( Add char to end of string a                                                                                                                                                                                                                                                                ( INPUT     LRP   9/30/84 )                                                     : SNIP  ( -- )                             PAD C@ IF                                       -1 PAD +!                              THEN ;                           ( If length o( INPUT    LRP  9/30/84 )                                                       : TERM?  ( c -- f; 1 means . ! or ? )      DUP EXCLAM = SWAP                       DUP PERIOD = SWAP                           QUESTION =                              OR OR ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          : TOOLONG?  ( -- f; 1 means string in )             ( PAD too long. )              PAD C@ MAX$ > ;                                                                                                                                                                                                                                                                                                                                                                                                                                                 ( Resets line length counter. )                                              : LONGER  ( -- )                           1 LONG +! ;                             ( increments line length counter. )                                  ( INPUT    LRP   9/30/84 )                                                      : MISTAKE? ( c -- f; 1 means BS or DEL)     DUP BACKSPACE = SWAP DELETE = OR ;                                                                                                                                                                                                                                                                                                                                                                  ( INPUT   LRP  9/30/84 )                                                        : INPUT   ( -- )                           CR 0 PAD C!         START               IT                                       KEY DUP EMIT       LONGER                   TOOLONG?                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                TINUE       DUP RETURN = IFF SP PAD !CHAR                            CR DROP CONTINUE       ( Any other char)                                        PAD !CHAR                                       CONTINUE     ENDIT ;                                                                                                                                                                                                                                                                                                        IFF CR ." You've                                   lost me! "                               BREAK          DUP TERM?    IFF PAD !CHAR CR                                    BREAK          DUP MISTAKE? IFF SNIP                                    DROP    CON                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ( COMPARE STRINGS   LRP  10/7/84 )                                              : -TEXT   ( adr1 n1 adr2 -- n2 )                                                      ( Compare strings character by )        ( character. String 1 at adr1; )        ( n1 is le                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 DROP SWAP C@ SWAP C@ -                          ( -TEXT =, compare )                    ( counts )                    THEN ;                                                                                                                                                                                                                                                                                                                                                                                   )                          DDUP SWAP COUNT ROT 1+  ( Set up )                 ( stack for -TEXT )          -TEXT                                   DUP IF                                        SWAP DROP SWAP DROP ( < or >)         ELSE                                                                                                                                                                                                                                                                                     ( COMPARE STRINGS    LRP  10/7/84 )                                             : STRINGS=?  ( adr1 adr2 -- flag )            ( String1 at adr1; string2 at )         ( adr2.  Flag = 0, strings are )        ( = ; flag -1, $1 < $2; flag 1 )        ( $1 > $2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 IF DUP ABS / LEAVE THEN              LOOP SWAP DROP ;                                                                                                                                                                                                                                                                                                                                                                                                                                                           ngth; string 2 at adr2)       ( If n2 = 1, $1>$2; if 0, $1=$2;)       ( if -1, $1<$2 )                                                               DDUP + 2+ SWAP                          DO DROP 1+ DUP 1-                          C@ I C@ - DUP                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Store )       ( data )                                                                                                                                                                                                                                                  6 RECORD DATA                                                                   300 22 CREATE-LIST FREE                                                         VARIABLE ROOT                           0 ROOT !                                EXIT     of link -- )                      ( Add new leaf to tree )        FREE GET DUP ROT ! ( link new leaf)     DUP 0 SWAP LEFT !  ( NIL in LEFT )      DUP 0 SWAP RIGHT ! ( NIL in RIGHT)      DUP 1 SWAP FREQ !  ( 1 in FREQ )        $BUFF SWAP DATA 18 CMOVE ; (                         : RECORD   ( n -- 0 )                      CREATE , DOES> @ + ;                                                         0 RECORD LEFT                           2 RECORD RIGHT                          4 RECORD FREQ                   ( GROW   LRP  10/7/84 )                                                         : LEAF?  ( adr of link -- f; 0 is NIL )          ( 1 if content of link is adr)     @ 0= ;                                                                      : NEWLEAF  ( Adr( DATA STRUCTURES    LRP  1/6/85 )                                              VARIABLE FREQLIST 1200 ALLOT            VARIABLE FREQPTR   FREQLIST FREQPTR !   : >FREQPTR    4 FREQPTR +! ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    BUFF 20 CMOVE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ( $BUFF   IN  LRP  1/6/85 )                                                     CREATE $BUFF 20 ALLOT                                                           : IN    ( Temp. string input word )         SP0 @ 20 EXPECT 0 >IN !                 1 TEXT PAD $                                                                                                                                                                                                                                                                ( GROW   LRP   10/7/85 )                                                        : COMPARE  ( Adr of node -- f )                    ( -1 means string in $BUFF)             ( < string in node; 0 means)            ( =; +1 means $BUFF > than )            ( nod                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 SWAP !                    ROOT @ RIGHT 0 SWAP !                   ROOT @ FREQ 0 SWAP !                    ROOT @ DATA 0 SWAP C! ;                                                      INIT-TREE                                                                                                                                                                                                                                                                                                                               ( GROW   LRP  10/7/84 )                                                         EXIT                                                                            : INIT-TREE ( -- )                         FREE GET ROOT !                         ROOT @ LEFT 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ONTINUE        ( GT )          RIGHT   CONTINUE   ENDIT ;                                                                                                                                                                                                                  0< ;                                                                         : COUNTUP   ( Adr of node -- )             FREQ 1 SWAP +! ;                                                                                                             )                         IT                                       DUP LEAF?  IFF      NEWLEAF BREAK           @                                   DUP COMPARE                             DUP SAME   IFF DROP COUNTUP BREAK           LT     IFF      LEFT    Ce.)                         DATA $BUFF SWAP STRINGS=? ;                                                 : SAME  ( f1 -- f2 )                       NOT ;                                                                        : LT    ( f1 -- f2 )            ( GROW  LRP  10/7/84 )                                                          : GROW  ( Adr of root -- )                      ( Search tree for string in )           ( $BUFF. If found, increment )          ( count in FREQ; else add new)          ( leaf.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             TEMP @ RIGHT @ TEMP ! ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     : .NODE  ( adr -- )                         DUP TEMP ! DUP DATA COUNT TYPE          DUP DATA C@ 25 SWAP - SPACES            FREQ @ . CR ;                                                               : >RIGHT  ( -- )                                                                                                                                                                                                                                                                                ( .TRAVERSE   LRP   10/7/84 )                                                   VARIABLE TEMP                                                                   : DONE?  ( n -- f; 0 not done; 1 done)      DEPTH NOT ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ( .TRAVERSE   LRP   10/7/84 )                                                   : NODE?  ( link -- f )                     TEMP @ ;                                                                     : CLIMB  ( link -- content of link)        TEMP @  DUP L                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                6 = IFF BREAK )             NODE?   IFF  CLIMB         CONTINUE     DONE?   IFF                BREAK        >FREQLIST  .NODE >RIGHT    CONTINUE    ENDIT ;                                                                                                      ( STRIP   LRP   10/13/84 )                                                      : -$BUFF    $BUFF 20 $ERASE ;                                                                                                                                                   ( .TRAVERSE    LRP   10/7/84 )                                                  : .TRAVERSE   ( Adr of root -- )           ROOT @ TEMP !                           CR                                      IT                                       ( .S   KEY 6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                : $ERASE    ( adr n -- )                   0 FILL ;                                ( Fill n bytes, starting at adr, )      ( with 0 )                                                                           req.)      ( in sort array )                                                                                                                                                                                                                                      SWAP                     DUP  96 >      SWAP                         123 < AND                                     OR   SWAP                          39 = OR ;                          ( Is character a valid letter? )                                     EFT @ TEMP ! ;                                                  : >FREQLIST  ( adr -- )                    DUP FREQPTR @ !                         DUP FREQ @ FREQPTR @ 2 + !              >FREQPTR ;                              ( Store address of node and f( STRIP   LRP   10/13/84 )                                                      : LETTER?  ( c -- f; 1 letter, 0 non-)             ( letter )                      DUP                                     DUP  64 >      OVER                          91 < AND                                                                                                                                                                                                                                                                ( STRIP    LRP    10/13/84 )                                                    : STRIP  ( -- )                            -$BUFF                                  PAD COUNT +   PAD 1+                    DO                                        I C@ DUP                                                                                                                                                                                                                                                                                                                   : COMPARE# ( n1 n2 -- f; where )                   ( n1 is index of freq )                 ( 1, and n2 is index of)                ( freq2 and f=1 means )                 ( freq 1 > freq 2.)                          frequency order.                                                                                                                                                                                                                                        0 FLAG ! ;                                                      : !GAP    #WORDS 2 / GAP ! ;            : /GAP    GAP @ 2 / GAP ! ;                                                     : WORD@   ( n -- adr )                       WORDPTR @ DATA ;           quency in               order and moves the address of each     node and the frequency associated with  that node into FREQLIST. FREQPTR points to the next free location in FREQLIST.  The next step is to sort FREQLIST on    the frequency value to get      ( SHELL SORT   LRP   1/8/85 )                                                   VARIABLE GAP                            VARIABLE FLAG                                                                   : EXCHANGE   1 FLAG ! ;                 : NO-EXCHANGE   EXIT                                    At this point, the program accepts      input in the form of sentences using    INPUT. STRIP adds the words to the      tree and maintains frequency counts.    .TRAVERSE prints out the words in the   tree and the fre                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               THEN                                  THEN                                  LOOP ;                                                                                                                                                                                                                               : #WORDS  ( -- n ; number of words in )           ( FREQLIST. )                      FREQPTR @ FREQLIST - 4 / ;                                                                                 LETTER?                      IF                                        $BUFF !CHAR                           ELSE                                      DROP $BUFF C@                           IF                                        ROOT GROW  -$BUFF      ( SORT    LRP    1/7/85 )                                                       : WORDPTR   ( n -- adr )                            ( points to entry in )                  ( FREQLIST. )                    4 * FREQLIST + ;                                     WORDPTR 2+ @                       SWAP WORDPTR 2+ @ > ;                                                                                                                                                                                                      ( SHELL SORT    LRP    1/8/85 )                                                                                         : SWAP'EM  ( n -- )                                ( swap I and I + 1 )             DUP WORDPTR D@ ROT                      DUP DUP 1+ W                                   REPEAT ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          THEN                                LOOP                                FLAG @                                  UNTIL                                 /GAP                                    GAP @                                   WHILE                                                                                                                                                                                                                                                                                               EXCHANGE                                #WORDS GAP @ - 0                          DO                                        I I 1+ COMPARE# 0>                        IF                                        I SWAP-EM                                                                                                                                                                                                                                                                        ( SHELL SORT    LRP   1/8/85 )                                                                                          : SORT   ( -- )                            !GAP                                    BEGIN                                     BEGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  #WORDS 0 DO                                        I WORDPTR 2+ @ .                          5 SPACES                              I WORD@ COUNT TYPE CR                 LOOP ;                                                     ORDPTR D@ ROT                   WORDPTR D!                              1+ WORDPTR D!                           46 EMIT                                 NO-EXCHANGE ;                                                                                           ( .FREQLIST    LRP   1/8/85 )                                                   : .FREQLIST   ( -- )                                  ( Print freq list )           CR CR                                   ." NO. WORDS = " #WORDS . CR            CR                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          