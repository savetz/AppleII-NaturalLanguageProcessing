( CGRAPH II LOAD SCREEN  LRP  1/27/85)                                          141 147 THRU   ( PARNAS' IT )           151 194 THRU                            250 253 THRU   ( LEXICON )              200 202 THRU   ( CGRAPH WORDS )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ST CAND-ID# )              ?COMP COMPILE 0BRANCH DUP               17 = IF    HERE ROT , SWAP                   ELSE  16 ?PAIRS 0 HERE 0 , 17           THEN ; IMMEDIATE                                                                                        R BRANCH ADDRESS -- )      SWAP OVER - SWAP ! ;                                                         : BACKFILL  ( TO-ADR LIST-ADR -- )         BEGIN DUP WHILE DUP @ >R OVER SWAP      BACK! R> REPEAT DROP DROP ;                                          ( IT...TI )                                                                     : CAND  ( IT-LOC ENDIT-LIST IT-ID#          ( OR  IT LOC ENDIT-LIST CAND-LIST       (     COR-LIST CAND-ID# -- IT-LOC )     (     ENDIT-LIST CAND-LIST  )           (     COR-LI( PARNAS' IT...TI STRUCTURE )                                                                                           : ROTB   ( N1 N2 N3 -- N3 N1 N2 )          ROT ROT ;                                                                    : BACK!  ( TO-AD                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                C ENDIT-LIST CAND-LIST       (     IFF-ID# -- )                    ?COMP DUP 18 = IF DROP HERE SWAP        BACKFILL 16 THEN 16 ?PAIRS HERE         SWAP BACKFILL DROP ; IMMEDIATE                                                                                                                                                                                                                                                                                                                                               ( IT...TI WORDS )                                                               : IT  ( -- IT-LOC ENDIT-LIST IT-ID# )      HERE 0 16 ; IMMEDIATE                                                        : ENDIT  ( IT-LOC ENDIT-LIST IT-ID# )        ( OR  IT-LO                                                                                                                                                                                                                                                                ( IT...TI WORDS )                                                               : COR  ( IT-LOC ENDIT-LIST IT-ID# )         ( OR IT-LOC ENDIT-LIST CAND-LIST )      (    COR-LIST CAND-ID# -- IT-LOC )      (    ENDIT-LIST CAND-LIST )             (    COR-LIS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ?COMP DUP 16 = IF 2+ 0 SWAP THEN        18 ?PAIRS >R COMPILE BRANCH HERE        SWAP , HERE R> BACKFILL 16 ;            IMMEDIATE                                                                                                                    P BACKFILL 16 ;             IMMEDIATE                                                                                                                                                                                                                           D DROP HERE ROT            BACKFILL 18 ; IMMEDIATE                                                      : BREAK ( IT-LOC ENDIT-LIST IT-ID# )         ( OR IT-LOC ENDIT-LIST CAND-LIST )      ( IFF-ID# -- IT-LOC ENDIT-LIST )        ( IT-ID# )                 ( IT...TI WORDS )                                                               : ENDSUB  ( CAND-LIST SUB-ID# IT-LOC )            ( ENDIT-LIST IT-ID# -- )                ( IT-LOC ENDIT-LIST IT-ID# )      ?COMP 16 ?PAIRS ROT 19 ?PAIRS           ROT HERE SWA( IT...TI WORDS )                                                               : IFF  ( IT-LOC ENDIT-LIST IT-ID# )        ( OR  IT-LOC ENDIT-LIST CAND-LIST )     (     COR-LIST CAND-ID# -- IT-LOC )     (     ENDIT-LIST CAND-LIST IFF-ID# )    [COMPILE] CAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        : SUBCASES ( IT-LOC ENDIT-LIST )                   ( CAND-LIST IFF-ID# )                   ( -- CAND-LIST SUB-ID# )                ( IT-LOC ENDIT-LIST IT-ID# )      ?COMP 18 ?PAIRS ROTB 19 ROTB 16 ;       IMMEDIATE                                                                                                                                                                                                                                                                                                  ID# )                      ?COMP DUP 16 = IF 2+ 0 SWAP THEN        18 ?PAIRS >R COMPILE BRANCH OVER        HERE 0 , BACK! HERE R> BACKFILL         16 ; IMMEDIATE                                                                                               T CAND-ID# )               ?COMP COMPILE 0= COMPILE 0BRANCH        DUP 17 = IF ROT HERE SWAP , ROTB        ELSE 16 ?PAIRS HERE 0 , 0 17 THEN ;     IMMEDIATE                                                                                                    ( IT...TI WORDS )                                                               : CONTINUE ( IT-LOC ENDIT-LIST IT-ID# )         ( OR IT-LOC ENDIT-LIST )                (    CAND-LIST IFF-ID# )                (    -- IT-LOC ENDIT-LIST )             (    IT-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ( CGAPH    LRP   1/26/85 )                                                      : CGRAPH ;                                                                      0 CONSTANT FALSE                                                                1 CONSTANT TRUE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ( LIST WORDS        LRP   1/26/85 )                                             : GET  ( n -- adr of link )                    ( Get link with n fields                  from HERE.)                        DUP HERE SWAP 0 FILL                        HERE SWA                                                                                                                                                                                                                                                                        : SUBTYPES    ( adr -- adr1 )               4 + ;                                                                       EXIT                                                                            CONCEPT is a defining word to create    concept  )          POS-PTR  @ ;                                                                : .POS   ( node.adr -- )                   @POS NFA ID. ;                                                                                                                                       : GRAPHS   ( adr -- adr1 )                  0 + ;                                                                       : SUPERTYPES  ( adr -- adr1 )               2+ ;                                                                                        : POS-PTR  ( node.adr -- )   4 + ;                                              : !POS   ( pos node.adr -- )                POS-PTR ! ;                                                                 : @POS  ( node.adr -- ptr to pos( CONCEPTS      LRP     1/11/85 )                                               : CONCEPT  ( -- )                           CREATE                                    0 , 0 , 0 ,                           DOES> ;                                             ( #LIST    LRP   1/26/85 )                                                      : POS  ( -- )                               ( Define POS )                          CREATE                                  DOES> ;                                                                                                                                                                                                                                                                                                             iven head of list, returns             no. elements in list. )             0 BEGIN    OVER @                         WHILE    1+   SWAP @ SWAP               REPEAT   SWAP DROP ;                                                                                                                               : .CONCEPT   ( node.adr -- )                 @CONCEPT NFA ID. ;                                                                                                                                                         : APPEND   ( le list -- )                   OVER 0 SWAP !                           BEGIN DUP @ WHILE                       @ REPEAT ! ;                                                                : #LIST   ( adr -- n )                       ( Gr of concept   node.adr               -- )                          CON-PTR ! ;                                                                 : @CONCEPT  ( node.adr -- ptr to                      concept )                     CON-PTR @ ;                 P ALLOT ;                                                       : PUT  ( list.adr  link.adr -- )            SWAP DDUP @ SWAP ! ( link <-                                        <list>)               ! ;      ( list <- link )                                 ( POS  LRP  1/26/85 )                                                           : CON-PTR   ( node.adr --  adr of ptr                 to concept )                  2+ ;                                                                        : !CONCEPT  ( adheaders in the FORTH            dictionary -- e.g. CONCEPT UNICORN.     UNICORN GRAPHS puts the address of the  pointer to the graph list on the stack.                                                                                                         ( CGRAPHS      LRP    1/11/85 )                                                 : VOCAB   ( -- )                            CREATE                                    0 ,    ( Ptr to concepts list. )      DOES> ( Eventually put processing               word                                                                                                                                                                                                                                                                                                                IS-A links together the                 SUBTYPE/SUPERTYPE lists. Example,       FELINE IS-A ANIMAL.                                                                                                                     MEANS links concept pointers to         lexicon entries.                        Example, NOUN cat MEANS ANIMAL. The     lexicon entry can be linked to multiple concepts.                                                                               TYPES   DUP 4 GET PUT                           @ !CONCEPT  ;                                                                                                                                                                   EXIT                            NCEPT                             @  !POS ;                                                                                                                                             EXIT                                                                    ( IS-A     LRP    1/13/85 )                                                     : IS-A         ( sub.adr  -- )             FIND 2+     ( sub.adr sup.adr -- )      DDUP SWAP SUPERTYPES DUP 4 GET PUT                           @  !CONCEPT                  SUB( MEANS    LRP    1/13/85 )                                                                                             : MEANS  ( pos list.adr con.adr -- )         FIND 2+            ( con.adr )          OVER 6 GET  PUT       ( link )          OVER @  !CO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                .       When the new word "unicorn" is executed the address of the head of the CONCEPTS list is put on the stack.                                                                                                                                                                              DUP @                                WHILE                                      @ DUP          .CONCEPT                   DUP 5 SPACES .POS                       CR                                 REPEAT DROP ;                here ) ;                                                       EXIT                                                                            VOCAB is a defining word to enter       lexicon entries into the FORTH          dictionary -- e.g. VOCAB unicorn( MEANS?   LRP   1/27/85 )                                                      : MEANS?   ( adr -- )                       ( Given address of word in lexicon,)    ( Traverse concept list. )              CR                                      BEGIN                                                                                                                                                                                                                                                                       (  RELATION    LRP   2/17/85 )                                                  : RELATION    ( n -- ; means relation                   is n-adic )                 CONSTANT ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  : SUPLIST  ( -- )                           ' SUPERTYPES LIST.PTR ! ;                                                   : @LIST   ( concept.adr -- list.adr )       LIST.PTR @ CFA EXECUTE ;                    @ LCHILD                    WHILE                                     NODE.PTR @ NODE.PTR @                   LCHILD NODE.PTR !                     REPEAT ;                                                                                                    R                                                               : GRAPHLIST   ( -- )                        ' GRAPHS LIST.PTR ! ;                                                       : SUBLIST  ( -- )                           ' SUBTYPES LIST.PTR ! ;     ( TYPES?  DENOTES?    LRP   1/27/85 )                                           : PLUNGE     ( -- n1 n2 ... n )             ( Assumes address of concept is)        ( stored in NODE.PTR. )                 BEGIN                                     NODE.PTR  ( TYPES?  DENOTES?   LRP   1/27/85 )                                            VARIABLE ROOT                                                                   VARIABLE NODE.PTR                                                               VARIABLE LIST.PT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ST @ ;                                                          : VISIT   ( adr -- )                        .CONCEPT  CR ;                                                                                                                                                                                                                                                                                                                                                                                                      ( TYPES?   DENOTES?   LRP   1/27/85 )                                           : LCHILD   ( adr1 -- adr2 )                 @ ;                                                                         : RCHILD   ( adr1 -- adr2 )                 @CONCEPT @LI                                                                                                                                                                                                                                                                ( TYPES?  DENOTES?   LRP    1/27/85 )                                           1 CONSTANT EXIT-FLG                                                             : STEPRT   ( -- flg )                       BEGIN                                     NODE.PTR @                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ROOT @  NODE.PTR !                      BEGIN                                     PLUNGE                                  STEPRT                                UNTIL                                 THEN ;                 EXIT                                                                            Now I will start on the interpreter for the linear representation of conceptual graphs. See Sowa p. 78 & p. 395.                                                                ( TYPES?  DENOTES?     LRP   1/27/85 )                                          : TRAV    (  -- )                            ( Assume head of list is stored           in ROOT )                             ROOT @                                      IF                                                                                                                                                                                                                                                                     L  ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         NODE.PTR !                              EXIT-FLG NOT                          ELSE                                      EXIT-FLG EXIT-FLG                     THEN                           THEN                              UNTI                                                                : DENOTES?  ( adr -- )                      SUBLIST                                 CR SUBTYPES @ ROOT !                    TRAV ;                                                               VISIT                        NODE.PTR @ RCHILD NODE.PTR !            NODE.PTR @                                  IF                                         EXIT-FLG NOT EXIT-FLG                ELSE                                       DEPTH IF           ( TYPES?  DENOTES?    LRP    1/27/85 )                                          : TYPES?  ( adr -- )                        SUPLIST                                 CR SUPERTYPES @ ROOT !                  TRAV ;                                                                                                                                                                                                                                                                                                              ( NODESPACE      LRP    2/3/85 )                                                2000 CONSTANT QUOTA                     ( Allocation for NODES  )                                                       VARIABLE NODESPACE QUOTA ALLOT          ( Space for node                                                                                                                                                                                                                                                                                                                EXIT                                                                            ( Variables used in graph construction)                                                                                                                                                                                                                                                                                                                                                                                 VARIABLE <CON>                          ( Ptr to current concept node )                                                 VARIABLE TEMP                           ( Temporary storage for concept           pointer )                     om in NODESPACE " ;                                                                                     EXIT                                                                            These words test whether or not free    space is available in NODESPACE.( VARIABLES    LRP  2/3/85 )                                                    VARIABLE <GRAPHS>                       ( Ptr to list of graphs )                                                                                                               ( NODES?    LRP     2/3/85 )                                                    : NODES?  ( n -- ; where n is value )             ( to be added to NODES. )         NODES @ +                               -NODES SWAP - 0<                        ABORT" No ro                                                                        Operators to make graphs relocatable                                                                                                                                                                                                                                                                                                                                                                                                                            : REL@   ( relative.adr -- n )              LOCATE @ ;                                                                  : REL!   ( n relative.adr -- )              LOCATE ! ;                                                                  EXIT                                                    EXIT                                                                            These words manage free space for       graph nodes                                                                             ASE )                      GBASE @ - ;                                                                  : LOCATE   ( offset from GBASE --                    node.adr )                    GBASE @ + ;                                                          s )                                                             VARIABLE NODES                          ( Ptr to free space in NODESPACE )                                              NODESPACE QUOTA + CONSTANT -NODES       ( Upper limit of NODESPACE )    ( Relocate operators   LRP   3/2/85 )                                           VARIABLE GBASE                          ( Base address of graph )                                                       : RELOCATE  ( node.adr -- offset from                 GB                                                                                                                                                                                                                                                                ( VARIABLES/RESET-NODES   LRP  2/3/85 )                                         VARIABLE <REL>                          ( Ptr to current relation node )                                                VARIABLE $BUFFER 40 ALLOT               ( String buffer                                                                                                                                                                                                                                                                             CSTACK.PTR @ @  ;                                                           EXIT                                                                            Operators for concepts stack.                                                           of      CGRAPH                                                                                                                                                                                                                                                  ; depth of CSTACK)          CSTACK.PTR @ CSTACK -  2 / ;                                                : CPOP  ( -- adr; pop adr from CSTACK)      CDEPTH 0=                               ABORT" CSTACK UNDERFLOW "               -2 CSTACK.PTR +!            s has been entered.)    0 ARCFLAG !                                                                                                             EXIT                                                                            Flags to control interpretation ( CSTACK    LRP   2/14/85 )                                                     : CPUSH  ( adr -- ; push adr on CSTACK)     CSTACK.PTR @ !                          2 CSTACK.PTR +! ;                                                           : CDEPTH  ( -- n( MORE VARIABLES   LRP  2/14/85 )                                               VARIABLE DIRFLAG                        ( 0 is <- ; 1 is -> )                                                           VARIABLE ARCFLAG                        ( 1 means arc ha                                Variables for concept and relation      stacks                                                                                                                                                                                                                                                                                                                                                                                                                                                          VARIABLE RSTACK.PTR                     ( Ptr to top of RSTACK )                                                        RSTACK RSTACK.PTR !                                                             EXIT                                                                                            RESET-NODES                                                                     EXIT                                                                            ( Variables used in graph construction)         CSTACK )                                                        CSTACK CSTACK.PTR !                                                             VARIABLE RSTACK 10 ALLOT                ( Stack for concept pointers )                                          )                                                               : RESET-NODES  ( -- )                       NODESPACE NODES !                       0 <GRAPHS> !                            0 <CON> !                               0 <REL> ! ;                 ( MORE VARIABLES   LRP  2/14/85 )                                               VARIABLE CSTACK 10 ALLOT                ( Stack for concept pointers )                                                  VARIABLE CSTACK.PTR                     ( Ptr to top of                                                                                                                                                                                                                                                                 ( RSTACK    LRP   2/14/85 )                                                     : RPUSH  ( adr -- ; push adr on RSTACK)     RSTACK.PTR @ !                          2 RSTACK.PTR +! ;                                                           : RDEPTH  ( -- n                                                                                                                                                                                                                                                                 )           LOCATE 6 + ;                                                               : REL-PTR  ( rnode.adr -- rel.ptr )          LOCATE 2+ ;                                                                : <CON-PTR  ( rnode.adr -- <con.adr )        LOC                                                                                                                                                                                                                                                                de.adr -- con.ptr )          LOCATE  2+ ;                                                               : REF-PTR  ( cnode.adr -- ref.adr )          LOCATE  4 + ;                                                              : OUT-PTR  ( cnode.adr -- in.adr                                                                                                                                                                                                                                                                ( NODE OPERATORS   LRP   2/3/85 )       ( Assumes node.adr relocatable )                                                : LINK-PTR  ( node.adr -- link.adr )         LOCATE ;                                                                   : CON-PTR  ( cno                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                EXIT                                                                            Return relative addresses                                                                                                                   RSTACK.PTR @ @ ;                                                            EXIT                                                                            Operators for relations stack.                                                          ATE ;                                                           : C-HEAD  ( -- n; n is relative )          GBASE @ 2+ RELOCATE ;                                                        : REL-HEAD  ( -- n; n is relative )        GBASE @ 4 + RELOCATE ;       ; depth of RSTACK)          RSTACK.PTR @ RSTACK -  2 / ;                                                : RPOP  ( -- adr; pop adr from RSTACK)      RDEPTH 0=                               ABORT" RSTACK UNDERFLOW "               -2 RSTACK.PTR +!            ( GRAPH HEAD WORDS  LRP  3/3/85 )                                               : G-COUNT  ( -- n; n is relative )         GBASE @ RELOCATE ;                                                           : G-LINK  ( -- n; n is relative )          GBASE @ RELOCATE 4 + ;                                                               : >CON-PTR  ( n rnode.adr -- >con.adr )     LOCATE 6 + SWAP 2 * + ;                                                                                                                     ( GETNODE      LRP   2/3/85 )                                                   : GETNODE  ( n -- adr of link )              ( Get link with n fields )              DUP NODES?                              DUP NODES @ SWAP  0 FILL                    NODES @                                EXIT                                                                            Words to link relocatable nodes to head or tail of linked list                                                                                  CEPT in             node. )                          NODES @ RELOCATE <CON> @ REF-PTR !           ( Store pointer to referent               in node. )                       $BUFFER NODES @                         $BUFFER C@ 1+ CMOVE                     $BU            BEGIN                                     DUP REL@                              WHILE                                     REL@                                  REPEAT                                  SWAP PUTNODE ;                              ed to <CON>. )               $BUFFER C@ 9 + NODES?                        ( Room in NODESPACE? )             8 GETNODE <CON> !                            ( Link node to <CON>. )            TEMP @  <CON> @ CON-PTR !                    ( Store pointer to CON@                           SWAP LOCATE !   ( link <- <list> )      SWAP LOCATE !  ;   ( list <- link )                                         : APPENDNODE   ( list.adr link.adr -- )     ( adrs are relative to GBASE )          SWAP                        ( CON-NODE    LRP   2/10/85 )                                                   : CON-NODE    ( -- )                            ( Given pointer to CONCEPT in             TEMP and referent string in             $BUFFER, create a new node )            ( link( RELATIVE LIST WORDS   LRP  3/23/85  )                                         : PUTNODE                                   ( list.adr link.adr --  )               ( adrs are relative to GBASE )          DDUP                                    SWAP LOCATE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ATE                          ( 0   is graph link/count                 2 + is concept list                     4 + is relation list )              PUT ;                                                                                                         SWAP                            NODES +!                                RELOCATE ;                                                                                                                                                                             ( NEWGRAPH     LRP   3/4/85 )                                                   : NEWGRAPH  ( -- )                         ( Set up graph header )                 NODES @ GBASE !                         <GRAPHS>                                6 GETNODE LOCFFER C@ 1+ NODES +!                       ( Move referent to REFSPACE. )     C-HEAD <CON> @ APPENDNODE ;                  ( Append to graph. )                                                                                                                  ( REL-NODE   LRP   2/14/85 )                                                    : REL-NODE  ( rel.pfa --  )                         ( create relation node                    linked to <REL> )             DUP CFA EXECUTE                         2* 4 + GETNO                                                                                                                                                                                                                                                                        : .RNODE   ( rnode.adr -- )                        ( rnode.adr is relative )       DUP REL-PTR @ NFA ID.                   5 SPACES                                <CON-PTR @ ?DUP IF                                        DUP .CON  .REF                                                                                                                                                                                                                                                                             .adr -- )                      ( print referent string. )            REF-PTR @ ?DUP IF                                       LOCATE                                  COUNT TYPE                            THEN ;                                               + ROT SWAP !                SWAP OUT-PTR RELOCATE                   SWAP PUTNODE ;                                                                                                                                                                              ( NODE OPERATORS   LRP   2/3/85 )       ( Assumes cnode.adr relocatable )                                               : .CON   ( cnode.adr -- )                    CON-PTR @ NFA ID. ;                                                        : .REF   ( cnode( LINK-ARC     LRP    3/8/85 )                                                  : LINK-ARC   ( cnode.adr rnode.adr -- )     ( Link rnode.ptr to cnode.                Addresses are relative. )             4 GETNODE                               DUP LOCATE 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ork                 for tri-adic relations!!! )     <CON> @ <REL> @ LINK-ARC                <CON> @ 0 <REL> @ REL-IN ;                                                                                                                                          ght                  location within rnode. )      <CON-PTR ! ;                                                                 : REL-IN  ( cnode.adr n rnode.adr -- )     >CON-PTR ! ;                                                                         > @ REL-OUT ;                                                   : CON-TO-REL  ( -- ; assumes concept                    pointing to relation;                   con.adr in <CON> and                    rel.adr in <REL> )                ( NOTE -- This won't wDE                          SWAP OVER REL-PTR !                     <REL> !                                 REL-HEAD <REL> @ APPENDNODE ;                                               : REL-OUT  ( cnode.adr rnode.adr -- )              ( Store concept in ri( REL-TO-CON/CON-TO-REL   LRP  2/9/85 )                                         : REL-TO-CON   ( -- ; assumes relation                   pointing to concept;                    con.adr in <CON> and                    rel.adr in <REL> )         <CON> @ <REL           THEN ;                                                                                                                                                                                                                                               ( .CARCS   LRP  3/9/85 )                                                        : .CARCS   ( cnode.adr -- )                CR OUT-PTR @                            BEGIN                                     DUP                                   WHILE                                                                                                                                                                                                                                                                                        IF DUP ABS / LEAVE THEN              LOOP SWAP DROP ;                                                                                                                                                                                                                                                                                                                                                                                                                                                           ngth; string 2 at adr2)       ( If n2 = 1, $1>$2; if 0, $1=$2;)       ( if -1, $1<$2 )                                                               DDUP + ( 2+ ) SWAP                      DO DROP 1+ DUP 1-                          C@ I C@ - DUP                                            DUP                                  WHILE                                      DUP .CNODE                              LOCATE @                             REPEAT DROP ;                                                     ( COMPARE STRINGS   LRP  10/7/84 )                                              : -TEXT   ( adr1 n1 adr2 -- n2 )                                                      ( Compare strings character by )        ( character. String 1 at adr1; )        ( n1 is le( .LIST    LRP   2/13/85 )                                                      : .CLIST  ( adr -- )                             ( Given head of list, prints              list of concept nodes. )          C-HEAD LOCATE @                          BEGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  concept, referent, and                  arcs pointing toward relations.         Cnode.adr is relative. )              CR DUP DUP .CON .REF .CARCS ;                                                                                                                                 DUP                                  WHILE                                      DUP .RNODE CR                           LOCATE @                             REPEAT DROP ;                                                                                  DUP LOCATE 2+ @ 5 SPACES .RNODE CR      LOCATE @                              REPEAT DROP ;                                                                : .CNODE    ( cnode.adr -- )               ( Given adr of node, print   ( .RLIST    LRP   2/13/85 )                                                     : .RLIST  (  -- )                                ( Prints list of relation                 nodes linked to REL-HEAD. )        CR REL-HEAD LOCATE @                    BEGIN                                                                                                                                                                                                                                                                     ( COMPARE STRINGS    LRP  10/7/84 )                                             : STRINGS=?  ( adr1 adr2 -- flag )            ( String1 at adr1; string2 at )         ( adr2.  Flag = 0, strings are )        ( = ; flag -1, $1 < $2; flag 1 )        ( $1 > $2    IF  NODE-EXISTS EXIT                    THEN                                 THEN LOCATE @                        REPEAT                                  DROP CON-NODE ;                                                                                                                                                                                                                                                                                                                                                     )           C-HEAD LOCATE @                         BEGIN                                       DUP                                 WHILE                                      DUP CON=?                               IF DUP REF=?                                                                                                                                                                                                                                                                                            EMP @ = ;                                                       : REF=?   ( adr -- f; where 1 is = )        REF-PTR @ LOCATE $BUFFER                STRINGS=? NOT ;                                                             : COMPARE-NODES   ( cnode.adr --                                                                                                                                                                                                                                                                ( COMPARE-NODES    LRP   2/10/85 )                                              : NODE-EXISTS   ( node.adr -- )             <CON> !  ;                                                                  : CON=?  ( node.adr -- f; where 1 is =)      CON-PTR @ T                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        If ARCFLAG is set, LINK-ARCS links      concept at <CON> to relation at         <REL>. DIRFLAG specifies whether        arc is pointing toward concept or       away from concept.                                                                                       DROP SWAP C@ SWAP C@ -                          ( -TEXT =, compare )                    ( counts )                    THEN ;                                                                                                                             ELSE                                      CON-TO-REL                            THEN                        THEN    0 ARCFLAG ! ;                                             EXIT                                                                    )                          DDUP SWAP COUNT ROT 1+  ( Set up )                 ( stack for -TEXT )          -TEXT                                   DUP IF                                        SWAP DROP SWAP DROP ( < or >)         ELSE                     ( LINK-ARC   LRP   2/15/85 )                                                    : LINK-ARCS  ( -- )                         ARCFLAG @ IF                                        DIRFLAG @ IF                                        REL-TO-CON                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ( ->   <-     LRP     2/3/85 )                                                  VOCABULARY CONGRAPHS                                                            CONGRAPHS DEFINITIONS                                                           : ->            FINITIONS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     COMPARE-NODES                           LINK-ARCS ;                                                               : (                                          FIND 2+ REL-NODE ;                                                         FORTH DE                                                                                                                                                                                                                                                                                                                                : ]   ( -- )                                  45 45 42 3                              4 0 DO                                         I $BUFFER + C!                       LOOP                                                                                                                                                                                                                                                                                  ( [  [  (     LRP     2/3/85 )                                                  CONGRAPHS DEFINITIONS                                                           : [    ( -- )                                  FIND 2+                                 TEMP ! ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 COMPARE-NODES                           LINK-ARCS ;                                                                                                     FORTH DEFINITIONS                                                                                                                       FORTH DEFINITIONS                                                                                                                                                                                                                                                               : :                                         93 WORD                                 DUP C@ 1+                                   $BUFFER                                 SWAP CMOVE                                          1 DIRFLAG !                             1 ARCFLAG ! ;                                                               : <-                                        0 DIRFLAG !                             1 ARCFLAG ! ;               \ :  )   LRP   2/13/85                                                          CONGRAPHS DEFINITIONS                                                           : )                                         DIRFLAG @ NOT DIRFLAG !                 LINK-ARCS ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         2 RELATION MATR                         2 RELATION PART                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ER                      CONCEPT INANIMATE                       CONCEPT CANINE                                                                  2 RELATION AGNT                         2 RELATION OBJ                          2 RELATION INST                                                WHILE                                     @ DUP IF                                        DUP CR .RELATION                      THEN                              DUP                                   REPEAT DROP ;            ( EXAMPLE ENTRIES    LRP   1/16/85 )                                                                                    CONCEPT FELINE                          CONCEPT MAMMAL                          CONCEPT ANIMATE                         CONCEPT EARTHMOV( .RLIST    LRP   2/13/85 )                                                     : .RLIST  ( adr -- )                             ( Given head of list, prints              list of concept nodes. )          <GRAPH>                                 1 BEGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ( DATA       LRP  1/26/85 )                                                     POS NOUN                                POS VERB                                POS ADJECTIVE                           POS ADVERB                              POS DET                                                                                                                                                                                                                                                                         ( EXAMPLE ENTRIES    LRP   1/16/85 )                                            FELINE IS-A MAMMAL                      MAMMAL IS-A ANIMATE                     EARTHMOVER IS-A INANIMATE               CANINE IS-A MAMMAL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      EPET                                                            CONCEPT ENTITY                          ANIMATE IS-A ENTITY                                                             CONCEPT POSSESSION                      HOUSEPET IS-A POSSESSION                                                                                                                                                                                                                                                                                                                                                                                                                                                                                CONCEPT HOUSEPET                        FELINE IS-A HOUS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        NOUN dog MEANS CANINE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           VOCAB cat                               VOCAB tabby                             VOCAB dog                                                                       NOUN cat MEANS FELINE                   NOUN cat MEANS EARTHMOVER                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       